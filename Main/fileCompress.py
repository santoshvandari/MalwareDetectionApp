# Using the deflate algorithm for file compression, write the code to compress the file.
import os
import zlib
import zipfile
from core.settings import MEDIA_ROOT

def compress_file_to_zip(filename):
    if not os.path.exists(filename):
        return False

    try:
    # Read the file content
        filepath= os.path.join(MEDIA_ROOT, 'UploadFiles', filename)
        with open(filepath, 'rb') as file:
            file_content = file.read()
        
        # Compress the content using zlib (Deflate algorithm)
        compressed_content = zlib.compress(file_content, level=9)
        
        # Define the path for the compressed ZIP file
        compressed_filepath = os.path.join(MEDIA_ROOT, 'CompressedFiles', f"{filename}.zip")
        
        # Write the compressed content to a ZIP file
        with zipfile.ZipFile(compressed_filepath, 'w', zipfile.ZIP_DEFLATED) as zipf:
            zipf.writestr(os.path.basename(filename), compressed_content)
        
        return True

    except Exception as e:
        print(f"An error occurred: {e}")
        return False

